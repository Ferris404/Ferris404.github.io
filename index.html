<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Color Separator</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/img-comparison-slider/dist/styles.css">
</head>
<body>
  <h1>Color Separator</h1>
  <p class="muted"></p>

  <div class="controls">
    <div class="control-group">
      <h3>Main</h3>
      <input id="file" type="file" accept="image/*">
      <label>Colors: <input id="colors" type="number" min="1" value="5"> <span id="colorsVal">5</span></label>
      <button id="process" class="primary">Separate</button>
    </div>
    <div class="control-group">
      <h3>Algorithm</h3>
      <label>Algorithm: 
        <select id="algorithm">
          <option value="kmeans">K-Means++</option>
          <option value="medianCut">Median Cut</option>
          <option value="octree">Octree Quantization</option>
          <option value="lab">LAB Color Space K-Means</option>
        </select>
      </label>
      <label>Color Space: 
        <select id="colorSpace">
          <option value="rgb">RGB</option>
          <option value="lab">LAB (Perceptual)</option>
          <option value="xyz">XYZ</option>
          <option value="hsv">HSV</option>
        </select>
      </label>
  <label><input id="perceptualWeighting" type="checkbox" checked> Perceptual color weighting</label>
  <label><input id="ciede2000" type="checkbox"> CIEDE2000 distance (LAB)</label>
    </div>
    <div class="control-group">
      <h3>Preprocessing</h3>
      <label>Preprocessing: 
        <select id="preprocessing">
          <option value="none">None</option>
          <option value="blur">Gaussian Blur</option>
          <option value="bilateral">Bilateral Filter</option>
          <option value="median">Median Filter</option>
        </select>
      </label>
      <label>Blur Strength: <input id="blurStrength" type="range" min="0.5" max="5" step="0.1" value="1.5"> <span id="blurStrengthVal">1.5</span></label>
      <label>Stray Pixel Size: <input id="strayPixelSize" type="range" min="0" max="20" value="5"> <span id="strayPixelSizeVal">5</span> pixels</label>
    </div>
    <div class="control-group">
      <h3>Advanced</h3>
      <label><input id="downsample" type="checkbox" checked> Downsample large images</label>
      <label id="downsampleOptions">Max size: <input id="downsampleSize" type="number" min="100" value="900" class="short-input"> px</label>
      <label><input id="randomSeed" type="checkbox" checked> Random seed</label>
      <label>Seed: <input id="seed" type="number" min="0" max="999999" value="12345" disabled> <span id="seedVal">12345</span></label>
    </div>
    <div class="control-group">
      <h3>Export</h3>
      <button id="download" class="secondary">Download Layers</button>
    </div>
    <div class="control-group">
      <h3>Palette</h3>
      <button id="mergeColors" class="secondary" disabled>Merge Selected</button>
      <p style="font-size:12px;line-height:1.2;margin:0;">Doubleâ€‘click swatch to lock. Shift+click or + badge to select multiple then merge.</p>
    </div>
  </div>

  <div class="row">
    <div class="left">
      <canvas id="preview" width="640" height="480"></canvas>
    </div>
    <div class="right">
      <div id="layers" class="layers"></div>
    </div>
  </div>

  <img-comparison-slider class="comparison">
    <img id="original-image" slot="first" src="" alt="Original Image">
    <div slot="second" class="processed-container">
      <img id="processed-image" src="" alt="Processed Image">
      <canvas id="highlight-overlay" style="position: absolute; top: 0; left: 0; pointer-events: none; opacity: 0;"></canvas>
    </div>
  </img-comparison-slider>

  <div class="palette" id="palette"></div>
  <div id="clusterStats" class="cluster-stats"></div>

  <footer></footer>

  <script src="https://cdn.jsdelivr.net/npm/jszip/dist/jszip.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/img-comparison-slider/dist/index.js"></script>
  <script type="module" src="main.js"></script>
</body>
</html>
